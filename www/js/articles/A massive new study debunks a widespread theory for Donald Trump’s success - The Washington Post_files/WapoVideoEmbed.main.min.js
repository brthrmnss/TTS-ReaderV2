!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _WapoVideoUtilsJs=require("./WapoVideoUtils.js"),BETA=(require("./WapoVideoSplunk.js"),!1),PTVBETA=!1,LOCAL=!1,USE_MIN_FILES=!0,IS_MOBILE=_WapoVideoUtilsJs.isMobile.any();exports.IS_MOBILE=IS_MOBILE;var JW_KEY="G6yAUySsWPP3LIJ9rejn8gFzXJvKj3Y3hrn4Ew==";exports.JW_KEY=JW_KEY;var QS_PARAMS={DEBUG:"wpv_debug",DEBUG_LEGACY:"ptvdebug",USE_LOCAL:"use_local",COMPACT:"_compact",RENDERING_MODE:"renderingMode",BANDITO_ENV:"wpvBanditoEnv",FORCE_PLAYER_VENDOR:"wpvForcePlayerVendor",INTERNAL_API:"wpvInternalApi"};exports.QS_PARAMS=QS_PARAMS;var QUERY_STRING_OBJ=function(){if(!window.location.search)return{};for(var queries=window.location.search.slice(1).split("&"),count=queries.length,queryStringObj={},i=0;count>i;i++){var query=queries[i].split("=");query[0]&&(query.length<2&&query.push(""),queryStringObj[decodeURIComponent(query[0])]=decodeURIComponent(query[1]))}return queryStringObj}();exports.QUERY_STRING_OBJ=QUERY_STRING_OBJ;var DEBUG=function(){var debugParam=QUERY_STRING_OBJ[QS_PARAMS.DEBUG]||QUERY_STRING_OBJ[QS_PARAMS.DEBUG_LEGACY];return"true"==debugParam||"1"==debugParam?!0:!1}();exports.DEBUG=DEBUG;var CACHE_BUST="?_=0435087";exports.CACHE_BUST=CACHE_BUST;var NAMESPACE="PostTV";exports.NAMESPACE=NAMESPACE;var USE_LOCAL="true"==QUERY_STRING_OBJ[QS_PARAMS.USE_LOCAL]||"1"==QUERY_STRING_OBJ[QS_PARAMS.USE_LOCAL]?!0:!1,BETA_CONTEXT_PATH="//www.washingtonpost.com/posttv-beta",PTVBETA_CONTEXT_PATH="//posttvbeta.washingtonpost.com/posttv-beta",PROD_CONTEXT_PATH="//www.washingtonpost.com/video",PB_LOCAL_CONTEXT_PATH="/pb",IMRS_URL="//img.washingtonpost.com/wp-apps/imrs.php?src=";exports.IMRS_URL=IMRS_URL;var BROWSER_INFO=(0,_WapoVideoUtilsJs.getBrowserInfo)();exports.BROWSER_INFO=BROWSER_INFO;var CONTEXT_PATH=function(){var contextPath=void 0,fullJsUrl=$('script[src*="posttv-video-embed.v3.main.js"], script[src*="posttv-video-embed.v3.main.min.js"], script[src*="WapoVideoEmbed.main.min.js"]').attr("src"),fullJsUrlResources=fullJsUrl?fullJsUrl.indexOf("/resources/env/WapoVideo/dist")>-1?fullJsUrl.indexOf("/resources/env/WapoVideo/dist"):fullJsUrl.indexOf("/resources/js/posttv")>-1?fullJsUrl.indexOf("/resources/js/posttv"):fullJsUrl.indexOf("/static/js/posttv"):-1;return fullJsUrlResources>=0?(DEBUG&&console.log("deriving contextpath from script tag url",fullJsUrl),contextPath=fullJsUrl.substr(0,fullJsUrlResources),0===contextPath.indexOf("http")&&(contextPath=contextPath.substr(contextPath.indexOf("//")))):USE_LOCAL||window.location.hostname.indexOf("local")>=0?(LOCAL=!0,contextPath=PB_LOCAL_CONTEXT_PATH):(0,_WapoVideoUtilsJs.urlContains)("posttvbeta.washingtonpost.com/posttv-beta/")||"ptvV2Beta"===QUERY_STRING_OBJ.ptvenv?(PTVBETA=!0,contextPath=PTVBETA_CONTEXT_PATH):(0,_WapoVideoUtilsJs.urlContains)("/posttv-beta/")||"beta"===QUERY_STRING_OBJ.ptvenv?(BETA=!0,contextPath=BETA_CONTEXT_PATH):contextPath=PROD_CONTEXT_PATH,(LOCAL||"false"==QUERY_STRING_OBJ[QS_PARAMS.COMPACT]||window.location.hostname.indexOf("local")>=0)&&(USE_MIN_FILES=!1),DEBUG&&console.log("context path:",contextPath),contextPath}();exports.CONTEXT_PATH=CONTEXT_PATH;var CONTEXT_PATH_JS=CONTEXT_PATH.replace("www.washingtonpost.com","js.washingtonpost.com");exports.CONTEXT_PATH_JS=CONTEXT_PATH_JS;var CONTEXT_PATH_CSS=CONTEXT_PATH.replace("www.washingtonpost.com","css.washingtonpost.com");exports.CONTEXT_PATH_CSS=CONTEXT_PATH_CSS;var VIDEO_JSON_URL=function(){var context=window.location.host.indexOf("local")>=0||(0,_WapoVideoUtilsJs.urlContains)("posttv-beta")?"posttv-beta":"video";return"//js.washingtonpost.com/"+context+"/c/videojson/"}();exports.VIDEO_JSON_URL=VIDEO_JSON_URL;var FIND_BY_UUID_URL=function(){var context=window.location.host.indexOf("local")>=0||(0,_WapoVideoUtilsJs.urlContains)("posttv-beta")?"posttv-beta":"video";return"//js.washingtonpost.com/"+context+"/findByUuid"}();exports.FIND_BY_UUID_URL=FIND_BY_UUID_URL;var FIND_BY_UUID_INTERNAL_URL=function(){return"//internal-posttv-api-internal-unpublished-1793588436.us-east-1.elb.amazonaws.com/posttv-api/api/v1/videos/findByUuid"}();exports.FIND_BY_UUID_INTERNAL_URL=FIND_BY_UUID_INTERNAL_URL;var FIND_BY_VIDEOID_URL=function(){var context=window.location.host.indexOf("local")>=0||(0,_WapoVideoUtilsJs.urlContains)("posttv-beta")?"posttv-beta":"video";return"//js.washingtonpost.com/"+context+"/findByVideoId"}();exports.FIND_BY_VIDEOID_URL=FIND_BY_VIDEOID_URL;var VIDEO_JSON_TIMEOUT=function(){var toReturn=6e3;try{toReturn=TWP[NAMESPACE].WapoVideoConfig.preloadVideojson.timeout?TWP[NAMESPACE].WapoVideoConfig.preloadVideojson.timeout:toReturn}catch(e){}return toReturn}();exports.VIDEO_JSON_TIMEOUT=VIDEO_JSON_TIMEOUT;var VARIANT_ENV=function(){var toReturn="prod";return/dev|stage|prod/.test(QUERY_STRING_OBJ[QS_PARAMS.BANDITO_ENV])&&(toReturn=QUERY_STRING_OBJ[QS_PARAMS.BANDITO_ENV]),toReturn}();exports.VARIANT_ENV=VARIANT_ENV;var VARIANT_JSON_URL=function(){var envs={dev:"https://mongo-good-server.ext.nile.works/test-statistics-dev?q=",stage:"https://mongo-good-server.ext.nile.works/test-statistics-stage?q=",prod:"https://mongo-good-server.ext.nile.works/test-statistics-prod?q="};return envs[VARIANT_ENV]}();exports.VARIANT_JSON_URL=VARIANT_JSON_URL;var VARIANT_POST_URL=function(){var envs={dev:"https://loxodo-ct-test.ext.nile.works/api/save",stage:"https://loxodo-ct-test.ext.nile.works/api/save",prod:"https://loxodo-ct.ext.nile.works/api/save"};return envs[VARIANT_ENV]}();exports.VARIANT_POST_URL=VARIANT_POST_URL;var VARIANT_TIMEOUT=function(){var toReturn=2e3;try{toReturn=TWP[NAMESPACE].WapoVideoConfig.bandito.timeout?TWP[NAMESPACE].WapoVideoConfig.bandito.timeout:toReturn}catch(e){}return toReturn}();exports.VARIANT_TIMEOUT=VARIANT_TIMEOUT;var LOADING_GIF="//img.washingtonpost.com/video/resources/img/loading_wp_white_100.gif";exports.LOADING_GIF=LOADING_GIF;var BACKGROUND_IMG=CONTEXT_PATH+"/resources/img/posttv/WP_Grey.jpg";exports.BACKGROUND_IMG=BACKGROUND_IMG;var FLAGS={SCRIPTS_LOADING:"SCRIPTS_LOADING",SCRIPTS_LOADED:"SCRIPTS_LOADED",SCRIPTS_YT_LOADING:"SCRIPTS_YT_LOADING",SCRIPTS_YT_API_LOADING:"SCRIPTS_YT_API_LOADING",STYLES_LOADED:"STYLES_LOADED"};exports.FLAGS=FLAGS;var SCRIPTS=function(){var contextPath=CONTEXT_PATH;contextPath.indexOf("www.washingtonpost.com")>=0&&(contextPath=contextPath.replace("www.washingtonpost.com","js.washingtonpost.com"));var jQuerySrc={src:"//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"},pubSubSrc={src:CONTEXT_PATH+"/resources/js/posttv/vendor/pubsub.js"},underscoreSrc={src:CONTEXT_PATH+"/resources/js/posttv/vendor/underscore-min.js",async:!1},streamSenseSrc={src:CONTEXT_PATH+"/resources/js/posttv/vendor/streamsense.min.js"},jwplayerSrc={src:CONTEXT_PATH_JS+"/resources/js/posttv/vendor/jw/jwplayer.js"+CACHE_BUST},jwWrapperSrc={src:CONTEXT_PATH_JS+"/resources/js/posttv/jwPlayer/jwPlayerWrapper"+(USE_MIN_FILES?".min":"")+".js"+CACHE_BUST},jwConfigSrc={src:"//videos.posttv.com/JWPlayer/JWPlayerConfig.js",timeout:5e3};window.location.hostname.indexOf("local")>-1&&(jwConfigSrc.src="/pb/resources/js/posttv/jwPlayer/JWPlayerConfig.js");var scripts=[];return"function"!=typeof window.jwplayer&&scripts.push(jwplayerSrc),window.TWP&&"object"==typeof TWP.PostTV&&"object"==typeof TWP.PostTV.jwPlayerConfig||scripts.push(jwConfigSrc),window.TWP&&"object"==typeof TWP.PostTV&&"function"==typeof TWP.PostTV.initInlinePlayerJW||scripts.push(jwWrapperSrc),window.jQuery||scripts.unshift(jQuerySrc),"function"!=typeof window._&&scripts.unshift(underscoreSrc),"object"!=typeof window.PubSub&&scripts.unshift(pubSubSrc),"object"!=typeof window.ns_&&scripts.unshift(streamSenseSrc),scripts}();exports.SCRIPTS=SCRIPTS;var SCRIPTS_YT=function(){var ytConfigSrc={src:"//videos.posttv.com/Youtube/YTConfig.js",timeout:5e3};window.location.hostname.indexOf("local")>-1&&(ytConfigSrc.src="/pb/resources/js/posttv/youtube/YTConfig.js");var scripts=[ytConfigSrc,{src:CONTEXT_PATH_JS+"/resources/js/posttv/youtube/ytWrapper"+(USE_MIN_FILES?".min":"")+".js"+CACHE_BUST}];return scripts}();exports.SCRIPTS_YT=SCRIPTS_YT;var SCRIPTS_YT_API={src:"https://www.youtube.com/iframe_api"};exports.SCRIPTS_YT_API=SCRIPTS_YT_API;var SCRIPTS_EXT=function(){var toReturn=[];return"undefined"==typeof window.vidExclusions&&toReturn.push({src:"//js.washingtonpost.com/wp-stat/advertising/pseudo-static/vidExclusions/vid_exclusions.js"}),toReturn}();exports.SCRIPTS_EXT=SCRIPTS_EXT;var STYLES=function(){var contextPath=CONTEXT_PATH;contextPath.indexOf("www.washingtonpost.com")>=0&&(contextPath=contextPath.replace("www.washingtonpost.com","css.washingtonpost.com"));var styles=[contextPath+"/resources/env/WapoVideo/css/WapoVideoPlayer.min.css"+CACHE_BUST];return(0,_WapoVideoUtilsJs.areFontsAvailable)()===!1&&styles.push(contextPath+"/resources/env/WapoVideo/css/WapoVideoFonts.min.css"+CACHE_BUST),"FontAwesome"!==$(".fa").css("font-family")&&styles.push("//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"),styles}();exports.STYLES=STYLES;var BREAKPOINTS={SMALL:450,SHARE_SMALL:768};exports.BREAKPOINTS=BREAKPOINTS;var CLASSES={BLACKOUT:"wpv-blackout",BLURB:"wpv-blurb",CAPTION:"wpv-caption inline-video-caption pb-caption",EMBED:"wpv-embed",EMBED_LEGACY:"posttv-video-embed",ERROR:"wpv-error",FIXED:"wpv-fixed",FONT_CANARY:"wpv-font-canary",HEADLINE:"wpv-headline",INLINE_VIDEO_CAPTION:"inline-video-caption",LOADING:"wpv-loading",MASTHEAD:"wpv-masthead",OO_PROCESSED:"ooyala-player-processed",OVERLAY:"wpv-overlay",PLAYER:"wpv-player",PLAY_BTN:"wpv-btn",PLAY_BTN_DURATION:"wpv-btn-duration",PLAY_BTN_TEXT:"wpv-btn-text",PROCESSED:"wpv-processed",PROMO:"wpv-promo",PROMO_LOGO:"wpv-promo-logo",SHADOW:"wpv-shadow",SHARE_SMALL:"wpv-share-small",SHARING:"wpv-video-sharing",SMALL:"wpv-small",TEASE:"wpv-tease",TOOLTIP_BUTTON:"wpv-tooltip-button",TOOLTIP_BUTTON_CLICKED:"wpv-tooltip-button-clicked",WAIT:"wpv-wait",WRAP:"wpv-wrap"};exports.CLASSES=CLASSES;var DOT_CLASSES=function(){var dotClasses={};return Object.keys(CLASSES).forEach(function(key){dotClasses[key]="."+CLASSES[key]}),dotClasses}();exports.DOT_CLASSES=DOT_CLASSES;var EVENTS={ADS_CLEARED:"adsCleared",AD_STARTED:"adStarted",CAST_FINISHED:"castFinished",CAST_NEXT_VIDEO:"castNextVideo",CAST_PAUSE:"castPause",CAST_PLAY:"castPlay",CAST_PROGRESS:"castProgress",CAST_READY:"castReady",CAST_SEEK:"castSeek",CAST_STARTED:"castStarted",CAST_VIDEO:"castVideo",CHANGED_GRID_SORTING:"changedGridSorting",COMPANION_ADS_DISPLAYED:"companionAdsDisplayed",CONTENT_TREE_FETCHED:"contentTreeFetched",DESTROY:"destroy",EDITORIAL_PLAY_STARTED:"editorialPlayStarted",ERROR:"videoError",FIRST_FRAME:"firstFrame",FULLSCREEN_CHANGED:"fullscreenChanged",NEED_RESIZE_VIDEO_ELEMENT:"needResizeVideoElement",OO_PLAYER_INITIALIZED:"ooPlayerInitialized",OO_PLUGIN_FULLY_LOADED:"ooPluginFullyLoaded",OO_PLUGIN_LOADED:"ooPluginLoaded",PAUSE:"pause",PAUSED:"paused",PLAY:"play",PLAYBACK_READY:"playbackReady",PLAYER_CREATED:"playerCreated",PLAYER_SERVICE_INITIALIZED:"playerServiceInitialized",PLAYHEAD_TIME_CHANGED:"playheadTimeChanged",PLAYING:"playing",PLAYLIST_DATA_LOADED:"playlistDataLoaded",PLAY_COMPLETED:"ooPlayCompleted",PLAY_NEXT_VIDEO:"playNextVideo",RATING_READY:"ratingReady",RATING_UPDATED:"ratingUpdated",SCRUBBER_NEEDS_ADJUSTMENT:"scrubberNeedsAdjustment",SEEK:"seek",SEND_TRACKING_DATA:"sendTrackingData",SET_VOLUME:"setVolume",SHOW_PROMO_SCREEN:"showPromoScreen",SKIP_AD:"skipAd",VOLUME_CHANGED:"volumeChanged",VOTES_LOADED:"votesLoaded",WILL_CHANGE_EMBED_CODE:"willChangeEmbedCode"};exports.EVENTS=EVENTS;var LIVE_UUIDS=["92d280a2-7d90-11e0-b6cc-e4e4a8a38cf0","cbf7a484-7d90-11e0-b6cc-e4e4a8a38cf0","02c9ecd4-1463-11e5-9518-f9e0a8959f32","7305a88c-9779-11e5-94f0-9eeaff906ef3","97e8b932-9779-11e5-94f0-9eeaff906ef3"];exports.LIVE_UUIDS=LIVE_UUIDS;var WOWZA_UUIDS=function(){var toReturn=["92d280a2-7d90-11e0-b6cc-e4e4a8a38cf0","cbf7a484-7d90-11e0-b6cc-e4e4a8a38cf0","02c9ecd4-1463-11e5-9518-f9e0a8959f32","7305a88c-9779-11e5-94f0-9eeaff906ef3"];try{toReturn=TWP[NAMESPACE].WapoVideoConfig.wowza_uuids?TWP[NAMESPACE].WapoVideoConfig.wowza_uuids:toReturn}catch(e){}return toReturn}();exports.WOWZA_UUIDS=WOWZA_UUIDS;var PAGE_INFO=(0,_WapoVideoUtilsJs.getPageInfo)();exports.PAGE_INFO=PAGE_INFO;var SCREENS={LOADING:"loading",BLACKOUT:"blackout",PROMO:"promo"};exports.SCREENS=SCREENS;var FEATURE_FLAGS=function(){var flags={LIVE_JW:!0,BANDITO:!0,PRELOAD_VIDEOJSON:!0,POSTLOAD_VARIANTS:!0,ALLOW_CAPTION:!0,FORCE_CAPTION:!1,VIDEOJSON_PROXY:!0};return $.each(flags,function(flag,value){if(window.TWP&&TWP[NAMESPACE]&&TWP[NAMESPACE].WapoVideoConfig&&TWP[NAMESPACE].WapoVideoConfig.featureFlags&&"undefined"!=typeof TWP[NAMESPACE].WapoVideoConfig.featureFlags[flag]&&(flags[flag]=TWP[NAMESPACE].WapoVideoConfig.featureFlags[flag]),"undefined"!=typeof QUERY_STRING_OBJ["wpvff_"+flag])switch(QUERY_STRING_OBJ["wpvff_"+flag]){case"true":case"1":flags[flag]=!0;break;case"false":case"0":flags[flag]=!1;break;default:flags[flag]=QUERY_STRING_OBJ["wpvff_"+flag]}}),flags}();exports.FEATURE_FLAGS=FEATURE_FLAGS;var EMBED_MAX_BITRATES=function(){var toReturn=void 0;return window.TWP&&TWP[NAMESPACE]&&TWP[NAMESPACE].WapoVideoConfig&&TWP[NAMESPACE].WapoVideoConfig.embedMaxBitrates&&(toReturn=TWP[NAMESPACE].WapoVideoConfig.embedMaxBitrates),toReturn}();exports.EMBED_MAX_BITRATES=EMBED_MAX_BITRATES},{"./WapoVideoSplunk.js":7,"./WapoVideoUtils.js":9}],2:[function(require,module,exports){"use strict";var _WapoVideoConstJs=require("./WapoVideoConst.js"),_WapoVideoUtilsJs=require("./WapoVideoUtils.js"),_WapoVideoPlayerWrapJs=require("./WapoVideoPlayerWrap.js");window.postTvProcessEmbeds=function(){_WapoVideoConstJs.DEBUG&&console.debug("postTvProcessEmbeds()");var queryClasses=[_WapoVideoConstJs.DOT_CLASSES.PLAYER,_WapoVideoConstJs.DOT_CLASSES.EMBED,_WapoVideoConstJs.DOT_CLASSES.EMBED_LEGACY].join(", ");$(queryClasses).not('[data-skip-processing="1"]').not(_WapoVideoConstJs.DOT_CLASSES.PROCESSED).each(function(i,el){var $el=$(el);0==i&&!_WapoVideoConstJs.BROWSER_INFO.isDeskweb&&"0"!==$el.attr("data-auto-init")||"1"===$el.attr("data-auto-init")?(_WapoVideoConstJs.DEBUG&&console.log("allowing auto-init"),$el.attr("data-clickable-when-ready","1")):"1"!==$el.attr("data-auto-init")&&(_WapoVideoConstJs.DEBUG&&console.log("disabling auto-init"),$el.attr("data-auto-init","0"),$el.attr("data-auto-play","1")),i>=1&&/iPhone|iPad|Android/.test(navigator.userAgent)&&(_WapoVideoConstJs.DEBUG&&console.debug("disabling endscreen"),$el.attr("data-show-endscreen","0")),$el.attr("data-loading-screen",_WapoVideoConstJs.SCREENS.BLACKOUT),$el.addClass(_WapoVideoConstJs.CLASSES.PROCESSED),(0,_WapoVideoUtilsJs.setupSiteRules)($el);var options=_WapoVideoConstJs.EMBED_MAX_BITRATES?{jwPlayerConfig:{maxBitrates:_WapoVideoConstJs.EMBED_MAX_BITRATES}}:{};(0,_WapoVideoPlayerWrapJs.initWapoVideoPlayer)($el,options)})},window.postTvProcessEmbeds(),window.TWP[_WapoVideoConstJs.NAMESPACE].initPostTvPlayer=function($el,options){_WapoVideoConstJs.DEBUG&&console.log("initPostTvPlayer()",$el,options);var $validEl=(0,_WapoVideoUtilsJs.normalizeEl)($el);if(!$validEl)return void console.log("initPostTvPlayer: No valid $el found.  Must be $, HTMLElement or id string");(0,_WapoVideoPlayerWrapJs.makeElBackwardsCompatible)($validEl);var player=($validEl.attr("id"),$validEl.attr("data-uuid"),void 0);options=options||{},options.shouldPrefetchVideoJson=!0,player=(0,_WapoVideoPlayerWrapJs.initWapoVideoPlayer)($validEl,options);var playUuid=function(uuid,args){_WapoVideoConstJs.DEBUG&&console.log("playUuid",uuid,args),"function"==typeof player.playUuid&&player.playUuid(uuid,args)},movePlayer=function($el){},drawPlayBtn=function(){};return{playUuid:playUuid,movePlayer:movePlayer,drawPlayBtn:drawPlayBtn}},$(window).trigger("initPostTvPlayerReady")},{"./WapoVideoConst.js":1,"./WapoVideoPlayerWrap.js":5,"./WapoVideoUtils.js":9}],3:[function(require,module,exports){"use strict";function initViewportTracking(){"function"==typeof $.fn.on&&$(window).on("load scroll",function(){$(_WapoVideoConstJs.DOT_CLASSES.PLAYER).each(function(i,el){var $el=$(el);(0,_WapoVideoUtilsJs.isElementInViewport)(el)&&!$el.data("has-been-visible")&&($el.attr("data-has-been-visible",!0),(0,_WapoVideoSplunkJs.sendEventToSplunk)(_WapoVideoSplunkJs.SPLUNK_EVENTS.event5_3.name,_WapoVideoSplunkJs.SPLUNK_EVENTS.event5_2.msg,"",{videoId:$el.data("uuid"),offsetTop:$el.offset().top,nthVideoOnPage:(0,_WapoVideoUtilsJs.getVideoNumberOnPage)($el)}),$el.attr("data-variant-id")?(0,_WapoVideoUtilsJs.postVariantServed)($el.data("object-id"),$el.data("variant-id")):$el.one("variantIdReady",function(){(0,_WapoVideoUtilsJs.postVariantServed)($el.data("object-id"),$el.data("variant-id"))}))})})}function initVideoSync(){function pauseSynced(active){$.each(players,function(key,player){key!=active&&player.sync&&(player.pause(),_WapoVideoConstJs.DEBUG&&console.log("Player",player.$playerContainer.attr("id"),"pausing in sync"))})}function onPlay(){PubSub.subscribe(_WapoVideoConstJs.EVENTS.PLAYING,function(msg,data){players[data.playerContainerId].sync&&(_WapoVideoConstJs.DEBUG&&console.log("Player",data.playerContainerId,"playing in sync"),pauseSynced(data.playerContainerId))})}var players=window.TWP[_WapoVideoConstJs.NAMESPACE].players;onPlay()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.initViewportTracking=initViewportTracking,exports.initVideoSync=initVideoSync;var _WapoVideoConstJs=require("./WapoVideoConst.js"),_WapoVideoUtilsJs=require("./WapoVideoUtils.js"),_WapoVideoSplunkJs=require("./WapoVideoSplunk.js")},{"./WapoVideoConst.js":1,"./WapoVideoSplunk.js":7,"./WapoVideoUtils.js":9}],4:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_WapoVideoTemplatesJs=require("./WapoVideoTemplates.js"),_WapoVideoConstJs=require("./WapoVideoConst.js"),_WapoVideoResLoaderJs=require("./WapoVideoResLoader.js"),_WapoVideoUtilsJs=require("./WapoVideoUtils.js"),_WapoVideoSplunkJs=require("./WapoVideoSplunk.js");Date.now||(Date.now=function(){return(new Date).getTime()});var WapoVideoPlayer=function(){function WapoVideoPlayer($el,options){return _classCallCheck(this,WapoVideoPlayer),this.startTime=Date.now(),this.$root=$el,this.$overlay,this.$loading,this.$blackout,this.$button,this.$wrap,this.id=this.$root.attr("id"),this.uuid=this.$root.data("uuid")||this.$root.data("videoUuid"),this.objectId=this.$root.data("object-id"),this.categoryId=this.$root.data("category-id"),this.videoJSON=options.json,this.options=options||{},this.options.elOptions=options.elOptions||{},_WapoVideoConstJs.DEBUG&&console.log("Constructing WapoVideoPlayer",this.$root,this.options),window.TWP[_WapoVideoConstJs.NAMESPACE].players&&"undefined"!=typeof window.TWP[_WapoVideoConstJs.NAMESPACE].players[this.id]?(console.log("Player with id:",this.id,"already exists on page. Returning created instance."),window.TWP[_WapoVideoConstJs.NAMESPACE].embeds[this.id]):(window.TWP[_WapoVideoConstJs.NAMESPACE].players[this.id]={},this.uuid||this.objectId||(console.log("Warning: No uuid or object ID found on",$el),(0,_WapoVideoSplunkJs.sendEventToSplunk)(_WapoVideoSplunkJs.SPLUNK_EVENTS.event996.name,_WapoVideoSplunkJs.SPLUNK_EVENTS.event996.msg,_WapoVideoSplunkJs.SPLUNK_EVENTS.event996.error)),(_WapoVideoConstJs.LIVE_UUIDS.indexOf(this.uuid)>-1||"live"===this.categoryId)&&(this.isLiveVideo=!0),this.options.elOptions.video360&&(this.is360Video=!0),_WapoVideoConstJs.WOWZA_UUIDS.indexOf(this.uuid)>-1&&(this.isWowzaVideo=!0),this._setup(),void(this.playUuid=this.playUuid))}return _createClass(WapoVideoPlayer,[{key:"_setDefaultSize",value:function(){this.$root.css("paddingBottom","56.25%")}},{key:"_drawOverlay",value:function(){this.$root.find(_WapoVideoConstJs.DOT_CLASSES.OVERLAY).length>0||(this.$overlay=_WapoVideoTemplatesJs.Overlay.overlay(),this.$masthead=this.$overlay.find(_WapoVideoConstJs.DOT_CLASSES.MASTHEAD),this.$root.append(this.$overlay),console.log("this.$root",this.$root))}},{key:"_drawIframe",value:function(){this.$iframe=_WapoVideoTemplatesJs.Iframe.iframe(this.iframeUrl),this.$root.append(this.$iframe)}},{key:"_drawErrorScreen",value:function(errorText){_WapoVideoConstJs.DEBUG&&console.log("_drawErrorScreen()",errorText);var errorWording=errorText||"This video is not available",$errorScreen=this.$overlay.find(_WapoVideoConstJs.DOT_CLASSES.ERROR+" div");$errorScreen.length>0?$errorScreen.html(errorWording):($errorScreen=_WapoVideoTemplatesJs.Overlay.error(errorWording),this.$overlay&&this.$overlay.append($errorScreen)),this.$overlay.show(),this.$overlay.find(".wpv-btn, .wpv-headline").hide()}},{key:"_drawBlackout",value:function(){this.$root.find(_WapoVideoConstJs.DOT_CLASSES.BLACKOUT).length>0||(this.$blackout=_WapoVideoTemplatesJs.Overlay.blackout(),this.$overlay&&this.$overlay.append(this.$blackout))}},{key:"_drawLoading",value:function(){this.$root.find(_WapoVideoConstJs.DOT_CLASSES.LOADING).length>0||(this.$loading=_WapoVideoTemplatesJs.Overlay.loading(),this.$overlay&&this.$overlay.append(this.$loading))}},{key:"_updateOverlay",value:function(args){"0"!==this.options.elOptions.playBtn&&(this.drawPlayBtn(args.duration,args.playText),args.duration&&(this.options.elOptions.duration=args.duration)),args.promo&&(this.drawPromo(args.promo),this.options.elOptions.promo=args.promo),args.headline&&(this.drawHeadline(args.headline),this.options.elOptions.headline=args.headline),this.uuid&&this.drawShareEmbed(),args.logo&&this.drawLogo(args.logo)}},{key:"_setSizeClass",value:function(){var width=this.$root.width();width<=_WapoVideoConstJs.BREAKPOINTS.SMALL?(this.$root.addClass(_WapoVideoConstJs.CLASSES.SMALL),this.$caption&&this.$caption.addClass(_WapoVideoConstJs.CLASSES.SMALL)):(this.$root.removeClass(_WapoVideoConstJs.CLASSES.SMALL),this.$caption&&this.$caption.removeClass(_WapoVideoConstJs.CLASSES.SMALL)),width<=_WapoVideoConstJs.BREAKPOINTS.SHARE_SMALL?this.$root.addClass(_WapoVideoConstJs.CLASSES.SHARE_SMALL):this.$root.removeClass(_WapoVideoConstJs.CLASSES.SHARE_SMALL)}},{key:"_setup",value:function(){var _this=this;this.options.elOptions.clickableWhenReady&&!this.isLiveVideo&&"youtube"!==this.options.elOptions.playerVendor&&this._makeNotClickable(),this.options.elOptions.shadow&&this.wrap();var _determineLoadingScreen=function(){switch(_this.options.elOptions.loadingScreen){case _WapoVideoConstJs.SCREENS.PROMO:_WapoVideoConstJs.DEBUG&&console.log("Using promo as loading screen for",_this.id),_this.$loading=_this.$overlay;break;case _WapoVideoConstJs.SCREENS.BLACKOUT:_WapoVideoConstJs.DEBUG&&console.log("Using blackout as loading screen for",_this.id),_this.$loading=_this.$blackout;break;default:_WapoVideoConstJs.DEBUG&&console.log("Using default loading screen for",_this.id),_this._drawLoading()}};this._drawOverlay(),this._drawBlackout(),this._setSizeClass(),_determineLoadingScreen(),this.options.elOptions.aspectRatio&&parseFloat(this.options.elOptions.aspectRatio)?this.$root.css("paddingBottom",100*this.options.elOptions.aspectRatio+"%"):this._setDefaultSize(),"boolean"==typeof this.options.shouldPrefetchVideoJson?this.shouldPrefetchVideoJson=this.options.shouldPrefetchVideoJson:"live"===_WapoVideoConstJs.FEATURE_FLAGS.PRELOAD_VIDEOJSON&&this.isLiveVideo?this.shouldPrefetchVideoJson=!0:this.shouldPrefetchVideoJson="boolean"==typeof _WapoVideoConstJs.FEATURE_FLAGS.PRELOAD_VIDEOJSON?_WapoVideoConstJs.FEATURE_FLAGS.PRELOAD_VIDEOJSON:!1,this.shouldPrefetchVariants=_WapoVideoConstJs.FEATURE_FLAGS.BANDITO&&!_WapoVideoConstJs.FEATURE_FLAGS.POSTLOAD_VARIANTS&&this.options.elOptions.variants,$.when(this.shouldPrefetchVideoJson?(0,_WapoVideoUtilsJs.ensureVideoJson)(this.videoJSON,this.uuid,this.objectId,this.isLiveVideo,this.$root):void 0,this.shouldPrefetchVariants?(0,_WapoVideoUtilsJs.ensureVariantJson)(this.variantJson,this.options.elOptions.objectId):void 0).then(function(videojson){videojson&&!$.isEmptyObject(videojson)&&(_this.videoJSON=videojson,_this.options.json=_this.videoJSON,_this.is360Video=_this.videoJSON.contentConfig.video360),_WapoVideoConstJs.FEATURE_FLAGS.BANDITO&&_WapoVideoConstJs.FEATURE_FLAGS.POSTLOAD_VARIANTS&&(_this.shouldFetchVariants=_this.videoJSON&&_this.videoJSON.contentConfig?_this.videoJSON.contentConfig.useVariants:"undefined"!=typeof _this.options.elOptions.variants?_this.options.elOptions.variants:!1),$.when(_this.shouldFetchVariants?(0,_WapoVideoUtilsJs.ensureVariantJson)(_this.variantJson,_this.options.elOptions.objectId):void 0).then(function(variantjson){variantjson&&!$.isEmptyObject(variantjson.metadata)&&(_this.variantJson=variantjson,_this.variantWinner=(0,_WapoVideoUtilsJs.getVariantWinner)(_this.variantJson),_this.$root.attr("data-variant-id",_this.variantWinner.variant_id),_this.$root.trigger("variantIdReady"));var promo=_this.variantWinner?_this.variantWinner.thumbnail:_this.videoJSON&&_this.videoJSON.promoImage&&_this.videoJSON.promoImage.image.url||_this.options.elOptions.promo,headline=_this.variantWinner?_this.variantWinner.title:_this.videoJSON&&_this.videoJSON.contentConfig&&_this.videoJSON.contentConfig.title||_this.options.elOptions.headline;_this._updateOverlay({duration:_this.videoJSON&&_this.videoJSON.contentConfig&&_this.videoJSON.contentConfig.videoDuration||_this.options.elOptions.duration,promo:promo,headline:headline,playText:_this.options.elOptions.playText,logo:_this.videoJSON&&_this.videoJSON.videoCategoryConfig&&_this.videoJSON.videoCategoryConfig[0].id||_this.options.elOptions.categoryId}),_this._init()})});var resizeHandler=function(){_this._setSizeClass()};$(window).resize(resizeHandler)}},{key:"_init",value:function(){var _this2=this,CHECK_DURATION=250,initWhenReady=function(data){var scriptChecker=window.setInterval(function(){window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_LOADED]&&(_WapoVideoConstJs.DEBUG&&console.log("Initializing",_this2.id),clearInterval(scriptChecker),_this2._initPlayer())},CHECK_DURATION)};"youtube"===this.options.elOptions.playerVendor?this._initYoutube():"iframe"===this.options.elOptions.playerVendor||this.is360Video?this._initIframe():this.isLiveVideo?"Android"===_WapoVideoConstJs.BROWSER_INFO.OS&&_WapoVideoConstJs.BROWSER_INFO.webview===!0?this._initYoutube():this.videoJSON&&this.videoJSON.liveEventConfig&&this.videoJSON.liveEventConfig.streams&&this.videoJSON.liveEventConfig.streams.length>0?initWhenReady():this.isWowzaVideo?initWhenReady():this._initYoutube():initWhenReady()}},{key:"_initOverlay",value:function(){var _this3=this,_loadingSequence=function(){_this3.$button.hide(),_this3.$loading.show()};this._updateOverlay({duration:this.options.elOptions.duration?this.options.elOptions.duration:null,playText:this.options.elOptions.playText}),this.$overlay.click(function(){_WapoVideoConstJs.IS_MOBILE||_loadingSequence(),_this3.$root.hasClass(_WapoVideoConstJs.CLASSES.WAIT)||(_this3.options.elOptions.promo&&((0,_WapoVideoSplunkJs.sendEventToSplunk)(_WapoVideoSplunkJs.SPLUNK_EVENTS.event6_3.name,_WapoVideoSplunkJs.SPLUNK_EVENTS.event6_3.msg,"",{videoId:_this3.uuid,src:_this3.options.elOptions.promo,isLiveVideo:_this3.isLiveVideo,offsetTop:_this3.$root.offset().top,nthVideoOnPage:(0,_WapoVideoUtilsJs.getVideoNumberOnPage)(_this3.$root),hasLocalStorage:function(){var toReturn=!1;try{localStorage.setItem("wpv_ls_test",!0),toReturn="true"==localStorage.getItem("wpv_ls_test")}catch(e){toReturn=!1}return toReturn}()}),_this3.variantWinner&&!_this3.variantClickPosted&&((0,_WapoVideoUtilsJs.postVariantClicked)(_this3.options.elOptions.objectId,_this3.variantWinner.variant_id),_this3.variantClickPosted=!0)),window.TWP[_WapoVideoConstJs.NAMESPACE].players&&window.TWP[_WapoVideoConstJs.NAMESPACE].players[_this3.id]&&"function"==typeof window.TWP[_WapoVideoConstJs.NAMESPACE].players[_this3.id].play?(_loadingSequence(),window.TWP[_WapoVideoConstJs.NAMESPACE].players[_this3.id].play()):window.TWP[_WapoVideoConstJs.NAMESPACE].initInlinePlayer(_this3.$root,_this3.options))}),window.PubSub.subscribe(_WapoVideoConstJs.EVENTS.PLAY_COMPLETED,function(msg,data){_WapoVideoConstJs.DEBUG&&console.log("EVENTS.PLAY_COMPLETED",data.playerContainerId,_this3.id),data.playerContainerId===_this3.id&&(_this3.$button&&_this3.$button.show(),_this3.options.elOptions.showEndScreen&&_this3.$root.hasClass(_WapoVideoConstJs.CLASSES.EMBED_LEGACY)&&data.hasRecommendedVideos?_this3.$blackout.show():_this3.$overlay.show())}),window.PubSub.subscribe(_WapoVideoConstJs.EVENTS.AD_STARTED,function(msg,data){_WapoVideoConstJs.DEBUG&&console.log("EVENTS.AD_STARTED",data.playerContainerId,_this3.id),data.playerContainerId===_this3.id&&(_this3.$blackout.hide(),_this3.$loading.hide(),_this3.$overlay.hide())}),window.PubSub.subscribe(_WapoVideoConstJs.EVENTS.PLAYING,function(msg,data){_WapoVideoConstJs.DEBUG&&console.log("EVENTS.PLAYING",data.playerContainerId,_this3.id),data.playerContainerId===_this3.id&&(_this3.$blackout.hide(),_this3.$loading.hide(),_this3.$overlay.hide())}),window.PubSub.subscribe(_WapoVideoConstJs.EVENTS.ERROR,function(msg,data){_WapoVideoConstJs.DEBUG&&console.log("EVENTS.ERROR",data.playerContainerId,_this3.id,data),data.playerContainerId===_this3.id&&(_this3.$blackout.hide(),_this3.$loading.hide(),_this3.$masthead.hide(),_this3._drawErrorScreen(data.errorMessage))})}},{key:"_makeClickable",value:function(){this.$root.removeClass(_WapoVideoConstJs.CLASSES.WAIT)}},{key:"_makeNotClickable",value:function(){this.$root.addClass(_WapoVideoConstJs.CLASSES.WAIT)}},{key:"_initPlayer",value:function(){var _this4=this,_setupOptions=function(){_this4.options.elOptions.clickableWhenReady&&(_this4.options.onload=function(){_this4._makeClickable()});var browser=_WapoVideoConstJs.BROWSER_INFO.browser.toLowerCase(),version=parseInt(_WapoVideoConstJs.BROWSER_INFO.version),width=_this4.$root.outerWidth(),height=_this4.$root.outerHeight();"chrome"===browser&&(width&&400>=width||height&&300>=height)&&!_this4.isLiveVideo&&(_WapoVideoConstJs.DEBUG&&console.log("Defaulting to html5 player in Chrome due to small size"),_this4.options.type="html5"),("safari"===browser||"edge"===browser)&&(_WapoVideoConstJs.DEBUG&&console.log("Defaulting to html5 player in "+browser+version),_this4.options.type="html5"),"explorer"===browser&&version>9&&parseFloat(_this4.options.elOptions.aspectRatio)<1&&(_WapoVideoConstJs.DEBUG&&console.log("Defaulting to html5 player in "+browser+version),_this4.options.type="html5"),"firefox"!==browser||_this4.isLiveVideo||(_WapoVideoConstJs.DEBUG&&console.log("Defaulting to html5 player in Firefox"),_this4.options.type="html5"),!_this4.isLiveVideo&&(0,_WapoVideoUtilsJs.getFlashPluginBlocked)()&&(_WapoVideoConstJs.DEBUG&&console.log("Defaulting to html5 player due to plugin"),_this4.options.type="html5"),_WapoVideoConstJs.PAGE_INFO.iabc&&(_WapoVideoConstJs.DEBUG&&console.log("Defaulting to html5 due to iabc mode"),_this4.options.type="html5"),/html5|flash/.test(_WapoVideoConstJs.QUERY_STRING_OBJ[_WapoVideoConstJs.QS_PARAMS.RENDERING_MODE])&&(_WapoVideoConstJs.DEBUG&&console.log("Defaulting to "+_WapoVideoConstJs.QUERY_STRING_OBJ[_WapoVideoConstJs.QS_PARAMS.RENDERING_MODE]+" from query string params"),
_this4.options.type=_WapoVideoConstJs.QUERY_STRING_OBJ[_WapoVideoConstJs.QS_PARAMS.RENDERING_MODE]),_WapoVideoConstJs.DEBUG&&console.log("Options for",_this4.id,"set up as",_this4.options)},_prepareContainer=function(){var fraction=9/16;_this4.options.elOptions.aspectRatio&&parseFloat(_this4.options.elOptions.aspectRatio)&&(fraction=_this4.options.elOptions.aspectRatio),_this4.$root.css("paddingBottom",100*fraction+"%")},_subscribe=function(){window.PubSub.subscribe(_WapoVideoConstJs.EVENTS.PLAYER_CREATED,function(msg,data){data.playerContainerId===_this4.id&&(_this4.options.elOptions.autoPlay&&window.TWP[_WapoVideoConstJs.NAMESPACE].players[_this4.id].play(),_this4.options.elOptions.videoSync&&(window.TWP[_WapoVideoConstJs.NAMESPACE].players[_this4.id].sync=!0))})};_prepareContainer(),_setupOptions(),_subscribe(),this._initOverlay(),this.options.elOptions.autoInit&&(_WapoVideoConstJs.DEBUG&&console.log("Called initInlinePlayer",(Date.now()-this.startTime)/1e3,"secs from video creation"),window.TWP[_WapoVideoConstJs.NAMESPACE].initInlinePlayer(this.$root,this.options))}},{key:"_initIframe",value:function(){var _this5=this,feature=this.isLiveVideo?"embed-live":"embed",contentId=this.isLiveVideo&&this.objectId?this.objectId:this.uuid,url=_WapoVideoConstJs.CONTEXT_PATH+"/c/"+feature+"/"+contentId+"?autoplay=1";this.$overlay.click(function(){_this5.$overlay.hide(),_this5.$iframe=_WapoVideoTemplatesJs.Iframe.iframe(url),_this5.$root.append(_this5.$iframe)})}},{key:"_initYoutube",value:function(){var _this6=this,ensureYoutubeIframeAPI=function(){_WapoVideoConstJs.DEBUG&&console.log("ensureYoutubeIframeAPI");var d=$.Deferred();return window.YT&&1===YT.loaded?d.resolve():!function(){var old=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){"function"==typeof old&&old(),d.resolve()},window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_YT_API_LOADING]||(window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_YT_API_LOADING]=!0,(0,_WapoVideoResLoaderJs.loadScripts)(_WapoVideoConstJs.SCRIPTS_YT_API))}(),d.promise()},ensureInitYoutubePlayer=function(){_WapoVideoConstJs.DEBUG&&console.log("ensureInitYoutubePlayer");var d=$.Deferred();return"function"==typeof TWP[_WapoVideoConstJs.NAMESPACE].initYoutubePlayer?d.resolve():($(window).one("initYoutubePlayerReady",function(){d.resolve()}),window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_YT_LOADING]||(window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_YT_LOADING]=!0,(0,_WapoVideoResLoaderJs.loadScripts)(_WapoVideoConstJs.SCRIPTS_YT))),d.promise()},init=function(){$.when(ensureYoutubeIframeAPI(),ensureInitYoutubePlayer()).then(function(){_this6.$overlay.hide(),_this6.$ytWrapper=_WapoVideoTemplatesJs.Youtube.wrapper(_this6.$root.attr("id")),_this6.$root.append(_this6.$ytWrapper),$.when((0,_WapoVideoUtilsJs.ensureVideoJson)(_this6.videoJSON,_this6.uuid,_this6.objectId,_this6.isLiveVideo,_this6.$root)).then(function(videojson){$.isEmptyObject(videojson)||(_this6.videoJSON=videojson,_this6.options.json=_this6.videoJSON);var youtubeId=_this6.options.elOptions.youtubeId?_this6.options.elOptions.youtubeId:_this6.videoJSON&&_this6.videoJSON.liveEventConfig&&_this6.videoJSON.liveEventConfig.youtubeEventId?_this6.videoJSON.liveEventConfig.youtubeEventId:_this6.videoJSON&&_this6.videoJSON.youtubeConfig&&_this6.videoJSON.youtubeConfig.youtubeVideoId?_this6.videoJSON.youtubeConfig.youtubeVideoId:void 0,options={videoId:youtubeId,autoplay:!0,json:_this6.videoJSON,loop:_this6.options.loop?!0:void 0};TWP.PostTV.initYoutubePlayer(_this6.$ytWrapper.attr("id"),options)})})};this.options.elOptions.autoInit&&this.options.elOptions.autoPlay||this.options.autoplay?init():this.$overlay.on("click",init)}},{key:"wrap",value:function(){var $wrap=_WapoVideoTemplatesJs.Wrap.wrap(),$fixed=_WapoVideoTemplatesJs.Wrap.fixed();$wrap.addClass(this.uuid+"_wrap"),this.$root.wrap($wrap).wrap($fixed),this.$fixed=this.$root.parent(),this.$wrap=this.$fixed.parent();var fraction=9/16;this.options.elOptions.aspectRatio&&parseFloat(this.options.elOptions.aspectRatio)&&(fraction=this.options.elOptions.aspectRatio),this.$wrap.css({"padding-bottom":100*fraction+"%"})}},{key:"playUuid",value:function(uuid,args){var _this7=this;return args=args||{},uuid?(this.videoJSON={},this.configuredShareEmbed=!1,this.configuredShareButtons=!1,this.$sharing&&("function"==typeof $.fn.off?this.$sharing.off():this.$sharing.unbind(),this.$sharing.show()),_WapoVideoConstJs.DEBUG&&console.log("Get videoJSON for",uuid),void(0,_WapoVideoUtilsJs.getVideoJSON)(uuid,this.$root).done(function(data){return 0===data.length?void console.log("No videoJSON found for",uuid,"Can't load video"):(_this7.videoJSON=data[0],$.extend(args,{methodeUuid:uuid,json:_this7.videoJSON}),void(window.TWP[_WapoVideoConstJs.NAMESPACE].players&&(_WapoVideoConstJs.DEBUG&&console.log("VideoJSON updated for",_this7.id,"with",_this7.videoJSON),window.TWP[_WapoVideoConstJs.NAMESPACE].players[_this7.id].onPlayNextVideo(args),_this7._updateOverlay({duration:_this7.videoJSON.contentConfig.videoDuration,headline:_this7.videoJSON.contentConfig.title,promo:_this7.videoJSON.promoImage.image.url}),_this7.$overlay.show())))}).fail(function(e){console.log("getVideoJSON: Could not fetch videoJSON",e),(0,_WapoVideoSplunkJs.sendEventToSplunk)(_WapoVideoSplunkJs.SPLUNK_EVENTS.event999.name,_WapoVideoSplunkJs.SPLUNK_EVENTS.event999.msg,"",{errorCode:"ptv_cannotRetrieveVideoJson",errorText:"Cannot retrieve video json data",videoId:uuid})})):void console.log("playUuid: No uuid found")}},{key:"reportEvent",value:function(name,msg){(0,_WapoVideoSplunkJs.sendEventToSplunk)(name,msg,"",{videoId:this.uuid,isLiveVideo:this.isLiveVideo,offsetTop:this.$root.offset().top,nthVideoOnPage:(0,_WapoVideoUtilsJs.getVideoNumberOnPage)(this.$root)})}},{key:"animateTo",value:function($anchor,opts){var _this8=this;_WapoVideoConstJs.DEBUG&&console.log("animateTo()");var options=opts||{};options.fixed=options.fixed||!1,options.zIndex=options.zIndex||1,options.shadow=options.shadow||!1,options.speed=options.speed||400,options.cb=options.cb||null;var relativeTofixed=function($anchor,cb){_WapoVideoConstJs.DEBUG&&console.log("relativeToFixed()",$anchor);var $fixed=_this8.$fixed,fixedOffset=$fixed.offset(),fixedWidth=$fixed.width(),anchorOffset=$anchor.offset(),anchorWidth=$anchor.width(),scrollTop=$(window).scrollTop();$fixed.css({position:"fixed",top:fixedOffset.top-scrollTop,left:fixedOffset.left,width:fixedWidth+"px","z-index":options.zIndex}),$fixed.css({"transition-duration":options.speed/1e3+"s","transition-timing-function":"ease-in-out",width:anchorWidth+"px",top:anchorOffset.top-$(window).scrollTop(),left:anchorOffset.left}),"function"==typeof cb&&$fixed.one("transitionend",cb),$fixed.find(".wpv-sticky").addClass("wpv-sticky-engaged")},fixedToRelative=function($anchor,cb){_WapoVideoConstJs.DEBUG&&console.log("fixedToRelative()",$anchor);var $fixed=_this8.$fixed,offset=$anchor.offset(),width=$anchor.width(),scrollTop=$(window).scrollTop(),fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement,isFullscreen=null!==fullscreenElement,transitionStyles={width:width,top:offset.top-scrollTop,left:offset.left,"z-index":""},toRelativeStyles={"transition-duration":"","transition-timing-function":"",position:"relative",top:"",left:"",width:"100%"};return isFullscreen?(_WapoVideoConstJs.DEBUG&&console.log("going relative in fullscreen"),$fixed.css(transitionStyles).css(toRelativeStyles),void("function"==typeof cb&&cb())):($fixed.css(transitionStyles),$fixed.one("transitionend",function(){$fixed.css(toRelativeStyles),"function"==typeof cb&&cb()}),void $fixed.find(".wpv-sticky").removeClass("wpv-sticky-engaged"))},animate=function($anchor,cb){options.fixed?relativeTofixed($anchor,cb):fixedToRelative(_this8.$wrap,cb)},cb=function(){_this8._setSizeClass(),"function"==typeof options.cb&&options.cb()};animate($anchor,cb)}},{key:"move",value:function($el){$el.append(this.$root)}},{key:"drawHeadline",value:function(headline){if(!headline)return void console.log("drawHeadline: No headline found");var $headline=this.$masthead.find(_WapoVideoConstJs.DOT_CLASSES.HEADLINE);$headline.length>0?$headline.html(headline):($headline=_WapoVideoTemplatesJs.Overlay.headline(headline),this.$masthead&&this.$masthead.append($headline))}},{key:"hideShareEmbed",value:function(){this.$sharing=this.$sharing||this.$overlay.find(_WapoVideoConstJs.DOT_CLASSES.SHARING),this.$tooltipButtons=this.$tooltipButtons||this.$sharing.find(_WapoVideoConstJs.DOT_CLASSES.TOOLTIP_BUTTON),this.$sharing.hide()}},{key:"drawShareEmbed",value:function(){var _this9=this,embedCodeTemplate=function(settings){return"<iframe width='"+settings.width+"' height='"+settings.height+"' scrolling='no' src='"+settings.hostname+settings.contextPath+(settings.isLive?"/c/embed-live/":"/c/embed/")+settings.videoID+"' frameborder='0' webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>"},setupEmbedTooltip=function(){_this9.$sharing&&_this9.videoJSON&&_this9.videoJSON.contentConfig&&(_this9.$sharing.find(".wpv-sharing-copy-input").attr("value",embedCodeTemplate({hostname:window.wp_pb&&wp_pb.hostname?wp_pb.hostname:"//www.washingtonpost.com",contextPath:window.wp_pb&&wp_pb.contextPath&&wp_pb.hostname?wp_pb.contextPath:"/video",videoID:"live"===_this9.videoJSON.contentConfig.type?_this9.videoJSON.id:_this9.videoJSON.contentConfig.uuid,isLive:"live"===_this9.videoJSON.contentConfig.type,height:_this9.videoJSON.contentConfig.vertical?480:290,width:_this9.videoJSON.contentConfig.vertical?290:480})),_this9.$sharing.find(".wpv-sharing-copy-button").click(function(event){event.stopPropagation(),$(event.currentTarget).parent().find(".wpv-sharing-copy-input").select(),document.execCommand("copy")}))},shareButtonHandler=function(shareButton){if(_this9.videoJSON&&_this9.videoJSON.contentConfig){var FACEBOOK="facebook",TWITTER="twitter",GOOGLE_PLUS="googleplus",popupDimensions="width=550, height=450, top="+(screen.height/2-225)+", left="+(screen.width/2-275),popup=void 0,popupTarget=void 0,shareType=shareButton.className.indexOf("facebook")>=0?FACEBOOK:shareButton.className.indexOf("twitter")>=0?TWITTER:shareButton.className.indexOf("google")>=0?GOOGLE_PLUS:"",shareURL=_this9.videoJSON.contentConfig.shortURL||"",shareTitle="live"===_this9.videoJSON.contentConfig.type?"Live on The Washington Post":_this9.videoJSON.contentConfig.title;_this9.videoJSON.contentConfig.blurb;switch(shareType){case FACEBOOK:popupTarget="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(shareURL);break;case TWITTER:popupTarget="https://twitter.com/share?url="+encodeURIComponent(shareURL)+"&text="+encodeURIComponent(shareTitle);break;case GOOGLE_PLUS:popupTarget="https://plus.google.com/share?url="+encodeURIComponent(shareURL);break;default:return}popup=window.open(popupTarget,"_blank",popupDimensions)}},setupShareEmbed=function(){"function"==typeof $.fn.off?_this9.$sharing.off():_this9.$sharing.unbind();var setupShareEmbedTooltips=function(){setupEmbedTooltip(),_this9.configuredShareButtons||(_this9.configuredShareButtons=!0,_this9.$sharing.find(".wpv-sharing-button").click(function(event){event.stopPropagation(),shareButtonHandler(event.currentTarget)})),_this9.$sharing.find(".wpv-sharing-button-email").attr("href",_WapoVideoTemplatesJs.Overlay.sharingEmailHREF(_this9.videoJSON))};_this9.configuredShareEmbed||(_this9.configuredShareEmbed=!0,_this9.$tooltipButtons.off().click(function(event){event.stopPropagation();var $tooltipButton=$(event.currentTarget);$tooltipButton.siblings().removeClass(_WapoVideoConstJs.CLASSES.TOOLTIP_BUTTON_CLICKED),$tooltipButton.toggleClass(_WapoVideoConstJs.CLASSES.TOOLTIP_BUTTON_CLICKED),$.when((0,_WapoVideoUtilsJs.ensureVideoJson)(_this9.videoJSON,_this9.uuid,_this9.objectId,_this9.isLiveVideo,_this9.$root)).then(function(videojson){return $.isEmptyObject(videojson)?(console.log("No videoJSON found for",_this9.uuid,"Can't load video"),void _this9.hideShareEmbed()):(_this9.videoJSON=videojson,_this9.options.json=_this9.videoJSON,void setupShareEmbedTooltips())})}))};this.$sharing||(this.$sharing=_WapoVideoTemplatesJs.Overlay.sharing(),this.$tooltipButtons=this.$sharing.find(_WapoVideoConstJs.DOT_CLASSES.TOOLTIP_BUTTON),this.$masthead.append(this.$sharing)),setupShareEmbed()}},{key:"drawPromo",value:function(src){var _this10=this,makeSrc=function(src){var fileType=src.split(".").pop();return"gif"==fileType?src:(0,_WapoVideoUtilsJs.getImrsUrl)(src,_this10.$root.width())};if(!src)return void console.log("drawPromo: No src found");if(this.$promo?this.$promo.css("background-image","url("+makeSrc(src)+")"):(this.$promo=_WapoVideoTemplatesJs.Overlay.promo(makeSrc(src)),this.$overlay&&this.$overlay.append(this.$promo)),(_WapoVideoConstJs.FEATURE_FLAGS.ALLOW_CAPTION&&this.options.elOptions.showCaption||_WapoVideoConstJs.FEATURE_FLAGS.FORCE_CAPTION)&&!this.$caption&&this.videoJSON&&this.videoJSON.contentConfig){var blurb=this.videoJSON.contentConfig.blurb,tease=this.videoJSON.contentConfig.shortDescription,editors=this.videoJSON.contentConfig.credits.editor,source=this.videoJSON.contentConfig.credits.source;if(this.$caption=_WapoVideoTemplatesJs.Caption.caption(blurb,tease,editors,source),this.$overlay){var siblings=this.$root.siblings(),$oldCaption=void 0;siblings.each(function(i,el){var $el=$(el);$el.hasClass(_WapoVideoConstJs.CLASSES.INLINE_VIDEO_CAPTION)&&($oldCaption=$el)}),$oldCaption?($oldCaption.hide(),$oldCaption.after(this.$caption)):this.$root.after(this.$caption)}}this._setSizeClass(),(0,_WapoVideoSplunkJs.sendEventToSplunk)(_WapoVideoSplunkJs.SPLUNK_EVENTS.event5_2.name,_WapoVideoSplunkJs.SPLUNK_EVENTS.event5_2.msg,"",{videoId:this.uuid,src:src,isLiveVideo:this.isLiveVideo,offsetTop:this.$root.offset().top,nthVideoOnPage:(0,_WapoVideoUtilsJs.getVideoNumberOnPage)(this.$root)})}},{key:"drawPlayBtn",value:function(duration,playText){var playWording=playText||(this.isLiveVideo?"Live Video":"Play Video");if(this.$button){var durationEl=this.$button.find(_WapoVideoConstJs.DOT_CLASSES.PLAY_BTN_DURATION),readableTime=(0,_WapoVideoUtilsJs.makeReadableTime)(duration);readableTime!=durationEl.html()&&durationEl.html(readableTime)}else this.$button=_WapoVideoTemplatesJs.Overlay.playBtn({text:playWording,duration:(0,_WapoVideoUtilsJs.makeReadableTime)(duration)}),this.$overlay&&this.$overlay.append(this.$button);this.$button.show()}},{key:"drawLogo",value:function(logo){if(logo){var $logo=this.$overlay.find(_WapoVideoConstJs.DOT_CLASSES.PROMO_LOGO);if($logo.length>0){var currentLogo=$logo.data("logo");logo!=currentLogo&&$logo.data("logo",logo)}else $logo=_WapoVideoTemplatesJs.Overlay.promoLogo(logo),this.$overlay&&this.$overlay.append($logo)}}}]),WapoVideoPlayer}();exports.WapoVideoPlayer=WapoVideoPlayer},{"./WapoVideoConst.js":1,"./WapoVideoResLoader.js":6,"./WapoVideoSplunk.js":7,"./WapoVideoTemplates.js":8,"./WapoVideoUtils.js":9}],5:[function(require,module,exports){"use strict";function loadRes(scripts,extScripts,styles,cb){function scriptsLoaded(){window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_LOADED]=!0,window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_LOADING]=!1,window.jwplayer&&(window.jwplayer.key=_WapoVideoConstJs.JW_KEY),cb(),(0,_WapoVideoResLoaderJs.loadScripts)(extScripts)}window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.STYLES_LOADED]||(window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.STYLES_LOADED]=!0,(0,_WapoVideoResLoaderJs.loadStyles)(styles)),window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_LOADING]||(window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_LOADING]=!0,(0,_WapoVideoResLoaderJs.loadScripts)(scripts,scriptsLoaded))}function makeBackwardsCompatible(){var queryClasses=[_WapoVideoConstJs.DOT_CLASSES.PLAYER,_WapoVideoConstJs.DOT_CLASSES.EMBED_LEGACY].join(", ");$(queryClasses).each(function(i,el){var $el=$(el);makeElBackwardsCompatible($el)})}function makeElBackwardsCompatible($el){function generateId($el){var uuid=$el.attr("data-uuid"),num=Math.floor(1e6*Math.random()),id="player-"+uuid+"-"+num;return _WapoVideoConstJs.DEBUG&&console.log("Generated id",id,"for",$el),id}"undefined"!=typeof $el.data("video-uuid")&&$el.attr("data-uuid",$el.data("video-uuid")),"undefined"!=typeof $el.data("allow-preroll")&&"undefined"==typeof $el.data("show-ad")&&$el.attr("data-show-ad",$el.data("allow-preroll")),$el.attr("id")||$el.attr("id",generateId($el)),$el.addClass(_WapoVideoConstJs.CLASSES.PLAYER)}function setPlayerVendor($el){if(/iframe|youtube|jw/.test(_WapoVideoConstJs.QUERY_STRING_OBJ[_WapoVideoConstJs.QS_PARAMS.FORCE_PLAYER_VENDOR]))return void $el.data("player-vendor",_WapoVideoConstJs.QUERY_STRING_OBJ[_WapoVideoConstJs.QS_PARAMS.FORCE_PLAYER_VENDOR]);if(!$el.data("player-vendor"))if("1"===$el.data("video-360")){var vendor=_WapoVideoConstJs.BROWSER_INFO.isDeskweb?"iframe":"youtube";$el.data("player-vendor",vendor)}else"live"===$el.data("category-id")&&$el.data("youtube-id")&&$el.data("youtube-id").length>0&&_WapoVideoConstJs.FEATURE_FLAGS.LIVE_JW!==!0?$el.data("player-vendor","youtube"):$el.data("player-vendor","jw")}function loadExtended(){(0,_WapoVideoExtJs.initVideoSync)(),(0,_WapoVideoExtJs.initViewportTracking)()}function initWapoVideoPlayer($el,options){console.log("initWapoVideoPlayer()",$el,options);var opts=options||{},$validEl=(0,_WapoVideoUtilsJs.normalizeEl)($el);if(!$validEl)return void console.log("initWapoVideoPlayer: No valid $el found.  Must be $, HTMLElement or id string");makeElBackwardsCompatible($validEl),setPlayerVendor($validEl),opts.elOptions=(0,_WapoVideoUtilsJs.harvest)($validEl);var player=new _WapoVideoPlayerJs.WapoVideoPlayer($validEl,opts);return window.TWP[_WapoVideoConstJs.NAMESPACE].embeds[$validEl.attr("id")]=player,player}function init(){(0,_WapoVideoUtilsJs.setupNamespace)(),makeBackwardsCompatible(),loadRes(_WapoVideoConstJs.SCRIPTS,_WapoVideoConstJs.SCRIPTS_EXT,_WapoVideoConstJs.STYLES,loadExtended),window.TWP[_WapoVideoConstJs.NAMESPACE].initWapoVideoPlayer=initWapoVideoPlayer}var _WapoVideoConstJs=require("./WapoVideoConst.js"),_WapoVideoResLoaderJs=require("./WapoVideoResLoader.js"),_WapoVideoUtilsJs=require("./WapoVideoUtils.js"),_WapoVideoExtJs=require("./WapoVideoExt.js"),_WapoVideoPlayerJs=require("./WapoVideoPlayer.js");init(),module.exports={initWapoVideoPlayer:initWapoVideoPlayer,makeElBackwardsCompatible:makeElBackwardsCompatible}},{"./WapoVideoConst.js":1,"./WapoVideoExt.js":3,"./WapoVideoPlayer.js":4,"./WapoVideoResLoader.js":6,"./WapoVideoUtils.js":9}],6:[function(require,module,exports){"use strict";function loadScripts(array,callback){array=Array.isArray(array)?array:[array];var loader=function(src,handler){var script=document.createElement("script");script.type="text/javascript",script.src="string"==typeof src.src?src.src:src,"undefined"!=typeof src.async&&(script.async=src.async);var timeoutHandler=void 0;src.timeout&&(timeoutHandler=setTimeout(function(){script.onreadystatechange=script.onload=script.onerror=null,handler()},src.timeout)),script.readyState?script.onreadystatechange=function(){("loaded"==script.readyState||"complete"==script.readyState)&&(script.onreadystatechange=null,clearTimeout(timeoutHandler),handler())}:script.onload=script.onerror=function(){clearTimeout(timeoutHandler),handler()};var head=document.getElementsByTagName("head")[0];(head||document.body).appendChild(script),console.log("Added script",src)},doLoad=function doLoad(){if(0!=array.length){var me=array.shift();loader(me,doLoad)}else console.log("All Scripts Loaded"),"function"==typeof callback&&callback()};doLoad()}function loadStyles(array){var head=document.getElementsByTagName("head")[0],loader=function(src,handler){var link=document.createElement("link");link.rel="stylesheet",link.type="text/css",link.href=src,link.media="all",head.appendChild(link),console.log("Added style",src),handler()},doLoad=function doLoad(){0!=array.length?loader(array.shift(),doLoad):console.log("All Styles Loaded")};doLoad()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadScripts=loadScripts,exports.loadStyles=loadStyles},{}],7:[function(require,module,exports){"use strict";function sendEventToSplunk(evtType,evtName,errorCode,props){_WapoVideoConstJs.DEBUG&&console.log("Sending event to splunk",evtType,evtName,errorCode,props),props=props||{};var browser=_WapoVideoConstJs.BROWSER_INFO.browser&&_WapoVideoConstJs.BROWSER_INFO.browser.toLowerCase(),browserOS=_WapoVideoConstJs.BROWSER_INFO.OS&&_WapoVideoConstJs.BROWSER_INFO.OS.toLowerCase(),browserVersion=_WapoVideoConstJs.BROWSER_INFO.version,webview=_WapoVideoConstJs.BROWSER_INFO.webview,thinkAdBlock=_WapoVideoConstJs.BROWSER_INFO.thinkAdBlock,data=$.extend({},{page:document.title.replace('"','\\"'),channel:channel,type:"video",browser:browser,os:browserOS,browserVersion:browserVersion,build:"0435087",webview:webview,url:props.isInlineEvt&&props.src?props.src:document.URL,HTTP_REFERER:props.isInlineEvt?document.URL:document.referrer,evtName:evtName,evtType:evtType,evtTime:props.evtTime?props.evtTime:Date.now(),errorCode:errorCode,vendor:props.isLiveVideo?"youtube":"jw",offsetTop:props.offsetTop,nthVideoOnPage:props.nthVideoOnPage,videoId:props.videoId?props.videoId:"",sessionId:document.cookie.match(/s_vi=([^;]+)/)?RegExp.$1:"",playerType:playerType,thinkAdBlock:thinkAdBlock,articlePageNum:props.articlePageNum,hasLocalStorage:props.hasLocalStorage});$.ajax({url:url,dataType:"jsonp",cache:!1,data:data})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.sendEventToSplunk=sendEventToSplunk;var _WapoVideoConstJs=require("./WapoVideoConst.js");Date.now||(Date.now=function(){return(new Date).getTime()});var url="//videotracker.washingtonpost.com/index.html",channel="wp - posttv",playerType="posttv-embed",SPLUNK_EVENTS={event5_2:{name:"event5_2",msg:"PostTV Promo Rendered"},event6_3:{name:"event6_3",msg:"PostTV Promo Clicked"},event5_3:{name:"event5_3",msg:"PTV embed viewable"},event999:{name:"event999",msg:"PostTV Player Data Error"},event994:{name:"PostTV Player posttv-beta",msg:"posttv-player.js loaded on posttv-beta"},event995:{name:"event995",msg:"Embed loading posttv-beta",error:"ptv_embedLoadingBeta"},event996:{name:"event996",msg:"Embed Script Missing Content ID",error:"ptv_embedMissingContentID"}};exports.SPLUNK_EVENTS=SPLUNK_EVENTS},{"./WapoVideoConst.js":1}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _WapoVideoConstJs=require("./WapoVideoConst.js"),Overlay={overlay:function(){return $('\n			<div class="'+_WapoVideoConstJs.CLASSES.OVERLAY+'" style="opacity: 0;">\n				<div class="'+_WapoVideoConstJs.CLASSES.MASTHEAD+'"></div>\n			</div>\n		')},blackout:function(){return $('<div class="'+_WapoVideoConstJs.CLASSES.BLACKOUT+'"></div>')},loading:function(){return $('<div class="'+_WapoVideoConstJs.CLASSES.LOADING+'"></div>')},playBtn:function(obj){function durationEl(duration){return duration?$('<span class="'+_WapoVideoConstJs.CLASSES.PLAY_BTN_DURATION+' franklin-light">'+duration+"</span>"):void 0}function symbolEl(){return $('<i class="fa fa-play"></i>')}function textEl(text){var wording=text||"Play Video";return $('<span class="'+_WapoVideoConstJs.CLASSES.PLAY_BTN_TEXT+' franklin-bold">'+wording+"</span>")}var btnObj=obj||{},wrap='<div class="'+_WapoVideoConstJs.CLASSES.PLAY_BTN+'"></div>',$wrap=$(wrap);return $wrap.append(symbolEl()),$wrap.append(textEl(btnObj.text)),$wrap.append(durationEl(btnObj.duration)),$wrap},headline:function(_headline){return $('<h3 class="'+_WapoVideoConstJs.CLASSES.HEADLINE+' franklin-light">'+_headline+"</h3>")},sharing:function(){return $('\n			<span class="wpv-video-sharing">\n				<span class="wpv-tooltip-button wpv-video-embed">\n					<span class="title">Embed</span>\n					<i class="fa fa-code icon-code"></i>\n					<span class="wpv-tooltip">\n						<span class="wpv-sharing-copy">\n							<span class="wpv-sharing-copy-input-wrap"><input type="text" class="wpv-sharing-copy-input" value=""></input></span>\n							<span class="wpv-sharing-copy-button">Copy</span>\n						</span>\n					</span>\n				</span>\n				<span class="wpv-tooltip-button wpv-video-social">\n					<span class="title">Share</span>\n					<i class="fa fa-share icon-share-alt"></i>\n					<span class="wpv-tooltip">\n						<i class="wpv-sharing-button fa fa-facebook icon-facebook"></i>\n						<i class="wpv-sharing-button fa fa-twitter icon-twitter"></i>\n						<i class="wpv-sharing-button fa fa-google-plus icon-google-plus"></i>\n						<a class="wpv-sharing-button-email" href="#">\n							<i class="fa fa-envelope icon-envelope"></i>\n						</a>\n					</span>\n				</span>\n			</span>\n		')},sharingEmailHREF:function(videoJSON){var stripHTML=function(dirtyString){var container=document.createElement("div");return container.innerHTML=dirtyString,$(container).text()};videoJSON=videoJSON||{},videoJSON.contentConfig=videoJSON.contentConfig||{};var shareURL=videoJSON.contentConfig.shortURL||"",shareTitle="live"===videoJSON.contentConfig.type?"Live on The Washington Post":videoJSON.contentConfig.title,shareBlurb=videoJSON.contentConfig.blurb;return"mailto:?subject="+encodeURIComponent(shareTitle)+"&body="+encodeURIComponent(stripHTML(shareBlurb))+"%20-%20"+encodeURIComponent(shareURL)},promo:function(src){var wrap='<div class="'+_WapoVideoConstJs.CLASSES.PROMO+'" style="background-image: url('+src+')"></div>';return $(wrap)},promoLogo:function(logo){return $('<span class="'+_WapoVideoConstJs.CLASSES.PROMO_LOGO+'" data-logo="'+logo+'"></span>')},error:function(text){var wording=text||"This video is not available";return $('<div class="'+_WapoVideoConstJs.CLASSES.ERROR+' franklin-light abs-center"><div class="abs-center">'+wording+"</div></div>")}};exports.Overlay=Overlay;var Iframe={iframe:function(src){return $('<iframe frameborder="0" scrolling="no" webkitallowfullscreen mozallowfullscreen allowfullscreen src="'+src+'"></iframe>')}};exports.Iframe=Iframe;var Youtube={wrapper:function(rootId){return $('<div id="'+rootId+'-youtube"></div>')}};exports.Youtube=Youtube;var Wrap={wrap:function(){return $('<div class="'+_WapoVideoConstJs.CLASSES.WRAP+'" style="background-image: url('+_WapoVideoConstJs.BACKGROUND_IMG+')"></div>')},fixed:function(){return $('<div class="'+_WapoVideoConstJs.CLASSES.FIXED+'"></div>')}};exports.Wrap=Wrap;var Caption={caption:function(blurb,tease,editors,source){var myEditors=editors?editors.replace(/,/g,", "):"",splitter=editors&&source?"/":"";return $('<div class="'+_WapoVideoConstJs.CLASSES.CAPTION+'" style="display:block">\n			<span class="'+_WapoVideoConstJs.CLASSES.BLURB+'">'+blurb+'</span>\n			<span class="'+_WapoVideoConstJs.CLASSES.TEASE+'">'+(tease?tease:blurb)+"</span>\n			("+myEditors+splitter+source+")\n		</div>")}};exports.Caption=Caption},{"./WapoVideoConst.js":1}],9:[function(require,module,exports){"use strict";function setupNamespace(){window.TWP=window.TWP||{},window.TWP[_WapoVideoConstJs.NAMESPACE]=window.TWP[_WapoVideoConstJs.NAMESPACE]||{},window.TWP[_WapoVideoConstJs.NAMESPACE].players=window.TWP[_WapoVideoConstJs.NAMESPACE].players||{},window.TWP[_WapoVideoConstJs.NAMESPACE].embeds=window.TWP[_WapoVideoConstJs.NAMESPACE].embeds||{},window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_LOADING]=window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_LOADING]||!1,window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_LOADED]=window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.SCRIPTS_LOADED]||!1,window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.STYLES_LOADED]=window.TWP[_WapoVideoConstJs.NAMESPACE][_WapoVideoConstJs.FLAGS.STYLES_LOADED]||!1,window.TWP[_WapoVideoConstJs.NAMESPACE].BrowserInfo=window.TWP[_WapoVideoConstJs.NAMESPACE].BrowserInfo||_WapoVideoConstJs.BROWSER_INFO,window.TWP[_WapoVideoConstJs.NAMESPACE].debug=_WapoVideoConstJs.DEBUG}function harvest($el){var aspectRatio="undefined"==typeof $el.data("aspect-ratio")?!1:$el.data("aspect-ratio");if(aspectRatio&&"string"==typeof aspectRatio&&aspectRatio.indexOf(":")>-1){var aspectRatioParts=aspectRatio.split(":");aspectRatio=parseInt(aspectRatioParts[1])/parseInt(aspectRatioParts[0])}return{aspectRatio:aspectRatio,autoInit:"0"==$el.data("auto-init")?!1:!0,autoPlay:"1"==$el.data("auto-play")||"1"==$el.data("autoplay")?!0:!1,categoryId:$el.data("category-id"),clickableWhenReady:"1"==$el.data("clickable-when-ready")?!0:!1,duration:"undefined"==typeof $el.data("duration")?!1:$el.data("duration"),headline:"undefined"==typeof $el.data("headline")?!1:$el.data("headline"),loadingScreen:"undefined"==typeof $el.data("loading-screen")?!1:$el.data("loading-screen"),objectId:"undefined"==typeof $el.data("object-id")?!1:$el.data("object-id"),playBtn:"0"==$el.data("show-play")?!1:!0,playerVendor:$el.data("player-vendor"),playText:"undefined"==typeof $el.data("play-text")?!1:$el.data("play-text"),promo:"undefined"==typeof $el.data("show-promo")?!1:$el.data("show-promo"),shadow:"1"==$el.data("show-shadow")?!0:!1,showCaption:"1"==$el.data("show-caption")?!0:!1,showEndScreen:"1"==$el.data("show-endscreen")?!0:!1,variants:"1"==$el.data("variants")?!0:!1,video360:"1"==$el.attr("data-video-360")?!0:!1,videoSync:"1"==$el.data("video-sync")?!0:!1,youtubeId:$el.data("youtube-id")}}function getVideoJSON(contentId,$el){var isUuid=contentId.indexOf("-")>-1?!0:!1,url=void 0,args=void 0,cbFunc=void 0;_WapoVideoConstJs.FEATURE_FLAGS.VIDEOJSON_PROXY?(url="1"===_WapoVideoConstJs.QUERY_STRING_OBJ[_WapoVideoConstJs.QS_PARAMS.INTERNAL_API]&&isUuid?_WapoVideoConstJs.FIND_BY_UUID_INTERNAL_URL+"?uuid="+contentId:isUuid?_WapoVideoConstJs.FIND_BY_UUID_URL+"/"+contentId:_WapoVideoConstJs.FIND_BY_VIDEOID_URL+"/"+contentId,cbFunc="cb"):(url=_WapoVideoConstJs.VIDEO_JSON_URL+contentId,cbFunc="callback"),_WapoVideoConstJs.DEBUG&&console.log("Get videoJSON from",url);var nthVideoOnPage=$el?getVideoNumberOnPage($el):0,cbName="cb_"+contentId.replace(/-/g,"")+"_"+nthVideoOnPage,deferred=$.ajax({type:"GET",url:url,contentType:"application/json",jsonp:cbFunc,jsonpCallback:cbName,data:$.extend({resType:"jsonp"},args),dataType:"jsonp",timeout:_WapoVideoConstJs.VIDEO_JSON_TIMEOUT,cache:!0});return deferred}function ensureVideoJson(json,uuid,objectId,isLive,$validEl){var d=$.Deferred(),contentId=isLive?objectId:uuid;return"object"==typeof json?d.resolve(json):getVideoJSON(contentId,$validEl).done(function(data){if(0===data.length)return console.log("No videoJSON found for",contentId,"Can't load video"),void d.resolve();var toReturn=$.isArray(data)?data[0]:data;d.resolve(toReturn)}).fail(function(e){console.log("getVideoJSON: Could not do videoJSON",e),(0,_WapoVideoSplunkJs.sendEventToSplunk)(_WapoVideoSplunkJs.SPLUNK_EVENTS.event999.name,_WapoVideoSplunkJs.SPLUNK_EVENTS.event999.msg,"",{errorCode:"ptv_cannotRetrieveVideoJson",errorText:"Cannot retrieve video json data",videoId:uuid}),d.resolve()}),d.promise()}function getVariantJSON(objectId){var params={_id:objectId},url=_WapoVideoConstJs.VARIANT_JSON_URL+JSON.stringify(params);_WapoVideoConstJs.DEBUG&&console.log("Get variantJSON from",url);var deferred=$.ajax({type:"GET",url:url,contentType:"application/json",timeout:_WapoVideoConstJs.VARIANT_TIMEOUT,cache:!0});return deferred}function ensureVariantJson(json,objectId){_WapoVideoConstJs.DEBUG&&console.log("ensureVariantJson",objectId,hasVariants);var d=$.Deferred();return"object"==typeof json?d.resolve():getVariantJSON(objectId).done(function(data){d.resolve(data.q_results[0])}).fail(function(e){console.log("getVariantJSON: Could not do variantJSON",e),d.resolve()}),d.promise()}function getVariantWinner(variantJson){_WapoVideoConstJs.DEBUG&&console.log("getVariantWinner",variantJson);var winner=variantJson.winner,toReturn={variant_id:winner};return $.each(variantJson.metadata,function(key,variant){key===winner&&(toReturn.thumbnail=variant.metadata.thumbnail,
toReturn.title=variant.metadata.title)}),toReturn}function postVariantServed(featureId,variantId){_WapoVideoConstJs.DEBUG&&console.log("postVariantServed()",featureId,variantId);var url=_WapoVideoConstJs.VARIANT_POST_URL,data={eventType:"served",featureid:featureId,variantid:variantId};$.ajax({type:"POST",url:url,data:JSON.stringify(data),contentType:"application/json",success:function(){console.log("on post success")}})}function postVariantClicked(featureId,variantId){_WapoVideoConstJs.DEBUG&&console.log("postVariantClicked()",featureId,variantId);var url=_WapoVideoConstJs.VARIANT_POST_URL,data={eventType:"clicked",featureid:featureId,variantid:variantId};$.ajax({type:"POST",url:url,data:JSON.stringify(data),contentType:"application/json",success:function(){console.log("on post success")}})}function urlContains(str){return window.location.href.indexOf(str)>=0}function getImrsUrl(src,width){function getPromoWidth(width){for(var widthBreakpoints=[300,360,400,480,540,600,650,750,800,1024],promoSize=window.TWP[_WapoVideoConstJs.NAMESPACE].BrowserInfo.isMobile||window.TWP[_WapoVideoConstJs.NAMESPACE].BrowserInfo.isTablet?400:600,i=1;i<widthBreakpoints.length&&width>=widthBreakpoints[i-1];i++)promoSize=widthBreakpoints[i];return width>promoSize&&(promoSize=width),promoSize}var url=src.replace(/^https?:/,"");return _WapoVideoConstJs.IMRS_URL+encodeURIComponent(window.location.protocol+url)+"&w="+getPromoWidth(width)}function getVideoNumberOnPage($el){return $(_WapoVideoConstJs.DOT_CLASSES.PLAYER).index($el)+1}function isElementInViewport(el,frac){"function"==typeof jQuery&&el instanceof jQuery&&(el=el[0]);var fraction=1>=frac&&frac>=0?frac:.5,rect=el.getBoundingClientRect();return rect.top+el.offsetHeight*fraction>=0&&rect.left>=0&&rect.bottom-el.offsetHeight*fraction<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)||rect.top<0&&rect.bottom>(window.innerHeight||document.documentElement.clientHeight)}function makeReadableTime(ms){function padNum(n){return n>9?""+n:"0"+n}return ms&&""!==ms?parseInt(""+ms/1e3/60)+":"+padNum(parseInt(""+ms/1e3%60)):""}function getAspectRatio(width,height){if(!width||!height)return console.log("getAspectRatio: please pass in a width and height"),null;var _ret=function(){var gcd=function(_x,_x2){for(var _again=!0;_again;){var a=_x,b=_x2;if(_again=!1,0===b)return a;_x=b,_x2=a%b,_again=!0}},ratio=gcd(width,height);return{v:width/ratio+":"+height/ratio}}();return"object"==typeof _ret?_ret.v:void 0}function getBrowserInfo(){var browserInfo={init:function(userAgentStr){this.userAgentStr=userAgentStr,this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(this.userAgentStr)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS",this.deviceType=this.lookUpDeviceType(this.dataDeviceType)||0,this.setupWebview(),this.setupThinkAdBlock(),this.isMobile=1===this.deviceType,this.isTablet=2===this.deviceType,this.isDeskweb=!(this.isMobile||this.isTablet)},searchString:function(data){for(var i=0;i<data.length;i++){var dataString="undefined"==typeof data[i].string?this.userAgentStr:data[i].string,dataProp=data[i].prop;if(this.version||(this.versionSearchString=data[i].versionSearch||data[i].identity),dataString&&-1!=dataString.indexOf(data[i].subString))return data[i].identity;if(dataProp)return data[i].identity}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(-1!=index)return dataString.substring(index+this.versionSearchString.length+1).match(/\d+(\.\d+)+/g)[0]},lookUpDeviceType:function(data){for(var dataString=void 0,i=0,l=data.length;l>i;i++)if(dataString="undefined"==typeof data[i].string?this.userAgentStr:data[i].string)if($.isArray(data[i].subString)){for(var j=0,jl=data[i].subString.length;jl>j;j++)if(-1!=dataString.indexOf(data[i].subString[j]))return"number"==typeof data[i].type?data[i].type:this.lookUpDeviceType(data[i].type)}else{if(-1!=dataString.indexOf(data[i].subString))return"number"==typeof data[i].type?data[i].type:this.lookUpDeviceType(data[i].type);if("undefined"!=typeof data[i].otherwise)return data[i].otherwise}},setupWebview:function(){var webview=!1;"Android"==this.OS&&this.userAgentStr.indexOf("Version")>-1?webview=!0:/iPhone|iPad/.test(this.OS)&&-1===this.userAgentStr.indexOf("Version")&&(webview=!0),this.webview=webview},setupThinkAdBlock:function(){var _this=this;$(function(){var adBlockCanaryMarkup='<div id="wpvCanary" class="bottomAd" style="color: white; height: 2px"></div>';0===$("#wpvCanary").length&&$("body").append(adBlockCanaryMarkup),_this.thinkAdBlock=!!($("#wpvCanary").filter(":hidden").length>0||0===$("#wpvCanary").filter(":visible").length)})},dataBrowser:[{subString:"Silk",identity:"Silk"},{subString:"Edge",identity:"Edge",versionSearch:"Edge"},{subString:"OPR",identity:"Opera",versionSearch:"OPR"},{subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{subString:"Firefox",identity:"Firefox"},{subString:"Netscape",identity:"Netscape"},{subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{subString:"Trident",identity:"Explorer",versionSearch:"rv"},{subString:"Android",identity:"Android Stock Browser",versionSearch:"Android"},{subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{subString:"Silk",identity:"Android for Kindle"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{subString:"iPhone",identity:"iPhone"},{subString:"iPad",identity:"iPad"},{subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Linux",identity:"Linux"}],dataDeviceType:[{subString:["iPhone","iPod"],type:1},{subString:["iPad","Silk"],type:2},{subString:["Android"],type:[{subString:["Firefox"],type:2},{subString:["Mobile"],type:1},{subString:null,otherwise:2}]},{subString:["Opera"],type:[{subString:["Mobi","Mini"],type:1}]},{subString:["AppleWebKit"],type:[{subString:["Mobile"],type:1}]},{subString:["Mobile"],type:1}]};return browserInfo.init(window.navigator.userAgent),browserInfo}function getPageInfo(){var isTWP=/washingtonpost.com|digitalink.com/.test(window.location.hostname);return{isTWP:isTWP,isPowerpost:isTWP&&/powerpost/i.test(window.location.href),isLiveBlog:isTWP&&$(".pb-f-liveblog-story-list").length>0,iabc:isTWP&&window.__iabc&&1==__iabc}}function setupSiteRules($el){(_WapoVideoConstJs.PAGE_INFO.isPowerpost||_WapoVideoConstJs.PAGE_INFO.iabc)&&$el.attr("data-show-ad",!1)}function mirrorDimensions($mirror,$reflection){var isBorderBox="border-box"===$reflection.css("box-sizing"),toHeight=isBorderBox?$reflection.height():$reflection.outerHeight(),toWidth=$reflection.width();$mirror.height(toHeight),$mirror.width(toWidth),$mirror.css("padding-bottom","0px")}function getFlashPluginBlocked(){var return_value=0;if(navigator.plugins["Shockwave Flash"]){var canary=$('<object id="canary" type="application/x-shockwave-flash" height="0" width="0"></object>');$("body").append(canary),"none"===canary.css("display")&&(return_value=2),canary.remove(),$("div[bginactive]").length>0&&(return_value=2)}else if(navigator.userAgent.indexOf("MSIE")>-1)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){return_value=2}else return_value=1;return return_value}function normalizeEl($el){return window.jQuery&&$el instanceof window.jQuery?$el:"string"==typeof $el?$("#"+$el):$el instanceof HTMLElement?$($el):void 0}function areFontsAvailable(){var fontsAvailable=void 0,fonts=[{"class":"franklin-light",fontFamily:"FranklinITCProLight"},{"class":"franklin-bold",fontFamily:"FranklinITCProBold"}],containerCss="position:absolute; width:auto; left:-99999px";return $.each(fonts,function(i,font){var container=$('<div style="'+containerCss+'" class="wpv-font-canary '+font["class"]+'">test</div>');$("body").append(container);var fontFamily=container.css("font-family")?container.css("font-family").split(","):[];font.isAvailable=fontFamily[0].indexOf(font.fontFamily)>-1,fontsAvailable="undefined"!=typeof fontsAvailable?fontsAvailable&&font.isAvailable:font.isAvailable}),fontsAvailable}Object.defineProperty(exports,"__esModule",{value:!0}),exports.setupNamespace=setupNamespace,exports.harvest=harvest,exports.getVideoJSON=getVideoJSON,exports.ensureVideoJson=ensureVideoJson,exports.getVariantJSON=getVariantJSON,exports.ensureVariantJson=ensureVariantJson,exports.getVariantWinner=getVariantWinner,exports.postVariantServed=postVariantServed,exports.postVariantClicked=postVariantClicked,exports.urlContains=urlContains,exports.getImrsUrl=getImrsUrl,exports.getVideoNumberOnPage=getVideoNumberOnPage,exports.isElementInViewport=isElementInViewport,exports.makeReadableTime=makeReadableTime,exports.getAspectRatio=getAspectRatio,exports.getBrowserInfo=getBrowserInfo,exports.getPageInfo=getPageInfo,exports.setupSiteRules=setupSiteRules,exports.mirrorDimensions=mirrorDimensions,exports.getFlashPluginBlocked=getFlashPluginBlocked,exports.normalizeEl=normalizeEl,exports.areFontsAvailable=areFontsAvailable;var _WapoVideoConstJs=require("./WapoVideoConst.js"),_WapoVideoSplunkJs=require("./WapoVideoSplunk.js"),isMobile={Android:function(){return navigator.userAgent.match(/Android/i)?!0:!1},AndroidOld:function(){return navigator.userAgent.match(/Android 2.3.3/i)?!0:!1},Kindle:function(){return navigator.userAgent.match(/Kindle/i)?!0:!1},KindleFire:function(){return navigator.userAgent.match(/KFOT/i)?!0:!1},Silk:function(){return navigator.userAgent.match(/Silk/i)?!0:!1},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)?!0:!1},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)?!0:!1},iPhone:function(){return navigator.userAgent.match(/iPhone|iPod/i)?!0:!1},iPad:function(){return navigator.userAgent.match(/iPad/i)?!0:!1},Windows:function(){return navigator.userAgent.match(/IEMobile/i)?!0:!1},FirefoxOS:function(){return navigator.userAgent.match(/Mozilla/i)&&navigator.userAgent.match(/Mobile/i)?!0:!1},Retina:function(){return window.retina||window.devicePixelRatio>1?!0:!1},any:function(){return isMobile.Android()||isMobile.Kindle()||isMobile.KindleFire()||isMobile.Silk()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Windows()||isMobile.FirefoxOS()},all:function(){return navigator.userAgent}};exports.isMobile=isMobile},{"./WapoVideoConst.js":1,"./WapoVideoSplunk.js":7}]},{},[2]);
//# sourceMappingURL=WapoVideoEmbed.main.min.js.map
